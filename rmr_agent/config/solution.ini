[general]
model_name = RMR_MODEL_ID
check_point = 
email_to = ${general:user}
state_file = 
cosmos_project = ${general:user}
gcp_app_id = 

[driver_creation]
bq_prefix = config['general_config']['bq_project_dataset_prefix']
file_path = ../config/base_config.yaml
hard_negative_impression_time_window = config['driver_config']['hard_negative_impression_time_window']
negative_sampling_avoid_delay_postive_feedback_window = config['driver_config']['negative_sampling_avoid_delay_postive_feedback_window']
oot_start_date = config['driver_config']['oot_start_date']
ratio_for_hard_negtive = config['driver_config']['ratio_for_hard_negtive']
removing_highly_active_user_merchant_date_threshold = config['driver_config']['removing_highly_active_user_merchant_date_threshold']
removing_highly_active_user_merchant_threshold = config['driver_config']['removing_highly_active_user_merchant_threshold']
removing_highly_active_user_threshold = config['driver_config']['removing_highly_active_user_threshold']
save_label_mixing_rate = config['driver_config']['save_label_mixing_rate']
train_start_date = config['driver_config']['train_start_date']
training_attributed_txn_upsampling_rate = config['driver_config']['training_attributed_txn_upsampling_rate']
training_exclude_merch = config['driver_config']['training_exclude_merch']
training_hot_negative_sampling_alpha = config['driver_config']['training_hot_negative_sampling_alpha']
training_hot_positive_attributed_txn_sampling_alpha = config['driver_config']['training_hot_positive_attributed_txn_sampling_alpha']
training_hot_positive_organic_txn_sampling_alpha = config['driver_config']['training_hot_positive_organic_txn_sampling_alpha']
uniform_negative_postive_ratio = config['driver_config']['uniform_negative_postive_ratio']
val_start_date = config['driver_config']['val_start_date']
driver_oot = {bq_prefix}driver_oot
driver_simu = {bq_prefix}driver_simu
driver_simu_consumer = {bq_prefix}driver_simu_consumer

[feature_engineering]
driver_consumer_base_gender_table = {bq_prefix}driver_consumer_base_gender

[data_pulling]
bq_materialization_dataset = rsh_row_gds_pacman
bq_materialization_project = pypl-bods
description = ranking_combined_datafetcher
driver_loc = ${general:gcs_base_path}/ql_store_rmr_driver_simu_consumer
gcp_project_id = ${general:dataproc_project_name}
gcs_bucket_name = ${general:dataproc_storage_bucket}
group_name = mls_gads
is_prod = True
job_name = ql_store_rmr
manager = Farhad
model_name = ql_store_rmr_datafetcher
model_owner = ${general:user}
num_of_splits = 1
on_gcp = True
seq_num = 20231005
split_ratio = {"train": 1.0}
stage = training
variables = ["prmry_addr_state", "days_on_file", "ebay_member_y_n", "consu_engagmnt_seg_key", "prmry_cc_type_code", "days_appweb_visit", "consu_age_band_key", "consu_income_band_key", "consu_dmgrphc_seg_key"]
data_loc = ${general:gcs_base_path}/ql_store_rmr_driver_simu_consumer_varmart

[feature_consolidation]
driver_dev_features_table = {bq_prefix}driver_dev_features
driver_oot_features_expand_seq_table = {bq_prefix}driver_oot_features_expand_seq
driver_oot_features_table = {bq_prefix}driver_oot_features
export_uri = ${general:gcs_base_path}/ql_store_rmr_driver_dev_features/part*.parquet

[data_preprocessing]
categorical_features = ["sndr_consu_engagmnt_seg_key", "sndr_ebay_member_y_n", "gender", ...]
chunk_size = 1000000
directory = ../data/ql_store_rmr_driver_dev_features
model_version_base = ../artifacts/din_<today_date>
numeric_features = ["sndr_rcvr_txn_num_30d", "sndr_rcvr_txn_num_180d", ...]
parquet_files = ["file1.parquet", "file2.parquet", ...]
rcvr_id_tokenizer_params = {"num_words": 1000, "oov_token": "<OOV>"}
state_to_abbreviation = {"ALABAMA": "AL", "ALASKA": "AK", ...}
categorical_feature_encoders_path = ../artifacts/din_<today_date>/exported_feature_transformer/categorical_feature_encoders
exported_feature_transformer = ../artifacts/din_<today_date>/exported_feature_transformer
model_version = din_<today_date>
numerical_feature_scalars_path = ../artifacts/din_<today_date>/exported_feature_transformer/numerical_feature_scalars
output_dir = ../data/ql_store_rmr_driver_dev_features_transformed
rcvr_id_tokenizer_path = ../artifacts/din_<today_date>/exported_feature_transformer/rcvr_id_tokenizer

[model_training]
att_activation = config['training_config']['DIN']['att_activation']
att_hidden_size = config['training_config']['DIN']['att_hidden_size']
att_weight_normalization = config['training_config']['DIN']['att_weight_normalization']
batch_size = config['training_config']['DIN']['batch_size']
dnn_activation = config['training_config']['DIN']['dnn_activation']
dnn_dropout = config['training_config']['DIN']['dnn_dropout']
dnn_hidden_units = config['training_config']['DIN']['dnn_hidden_units']
dnn_use_bn = config['training_config']['DIN']['dnn_use_bn']
epochs = config['training_config']['DIN']['epochs']
gpt_cate_names = ["gpt_1st_category_l2_index", "sndr_1st_freq_merchant_category_30d", ...]
l2_reg_dnn = config['training_config']['DIN']['l2_reg_dnn']
l2_reg_embedding = config['training_config']['DIN']['l2_reg_embedding']
learning_rate = config['training_config']['DIN']['learning_rate']
numeric_names = ["sndr_rcvr_txn_num_30d", "sndr_rcvr_txn_num_180d", "sndr_rcvr_txn_num_365d", ...]
rcvr_id_names = ["rcvr_id"]
seed = config['training_config']['DIN']['seed']
train_data_path = ../data/ql_store_rmr_driver_dev_features_transformed
model_artifact_path = os.path.join(exported_model_base, 'din.h5')
tf_model_path = os.path.join(exported_model_base, 'din_saved_model')

[model_packaging]
trained_model_path = os.path.join(exported_model_base, 'din_saved_model')
onnx_model_path = os.path.join(exported_model_base, 'din.onnx')
oot_scoring_path = os.path.join(exported_model_base, 'oot_scoring')
prod_model_path = os.path.join(exported_model_base, 'din_prod.m')

[model_scoring]
eval_path = ${general:gcs_base_path}/ql_store_rmr_oot_transformed_scored
exported_model_base = ${general:local_output_base_path}/artifacts/{model_version}/exported_models
m_gcp_folder = ${general:gcs_base_path}/challenger/oot_scoring
m_local_folder = ${general:local_output_base_path}/artifacts/din_20240708/18/exported_models/oot_scoring
model_version_path = ${general:local_output_base_path}/_current_model_version
oot_data_path = ${general:gcs_base_path}/ql_store_rmr_oot_transformed
params_path = ${general:local_output_base_path}/config
section_name = oot_data_scoring
working_path = ${general:local_output_base_path}
eval_result_path = ${general:gcs_base_path}/ql_store_rmr_oot_transformed_scored
log_file = ${general:local_output_base_path}/logs/{job_id}.log

[model_evaluation]
bq_project_dataset_prefix = {config['general_config']['bq_project_dataset_prefix']}
config_file_path = ../config/base_config.yaml
model_version_base = ../artifacts/{model_version}/18
model_version_path = ../_current_model_version
oot_start_date = {config['driver_config']['oot_start_date']}
remove_list = '1365556366671835703','2254348706417584521','1581565211190403045','1157330454984142772','1339933886421356550','1812170125034785903','6053464759929799123','1587111025150613712','1672368731209095395','1365556366671835703','6085552794250364378','1954349237309389875'
exported_eval_readout_base = ../artifacts/{model_version}/18/exported_eval_readouts
performance_all_csv = ../artifacts/{model_version}/18/exported_eval_readouts/performane_all.csv
performance_all_png = ../artifacts/{model_version}/18/exported_eval_readouts/performane_all.png
performance_ftu_csv = ../artifacts/{model_version}/18/exported_eval_readouts/performane_ftu.csv
performance_ftu_png = ../artifacts/{model_version}/18/exported_eval_readouts/performane_ftu.png
performance_wo_ebay_csv = ../artifacts/{model_version}/18/exported_eval_readouts/performane_wo_ebay.csv
performance_wo_ebay_png = ../artifacts/{model_version}/18/exported_eval_readouts/performane_wo_ebay.png