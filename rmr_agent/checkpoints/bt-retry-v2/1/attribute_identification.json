{
  "attribute_identification": [
    "### Driver Creation:\n    Inputs:\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_transactions\n        - Source Table: pypl-edl.braintree_raw_tables.authy_merchants\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_payment_methods\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_credit_cards\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_network_tokenization_enrollments\n        - Source Table: pypl-edw.pp_access_views.dim_curr_exchng_rate_dly\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_credit_card_details\n        - Source Table: pypl-edw.pp_cmt_access_views.bt_unbranded_retry_bin\n        - Source Table: pypl-edw.pp_cmt_access_views.bt_unbranded_retry_strategy\n        - Source Table: pypl-edw.pp_cmt_access_views.bt_unbranded_retry_bin_strategy\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_three_d_secure_results\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_three_d_secure_verifications\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_verifications\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_vaulted_payment_method_grants\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_salem_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_adyen_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_world_pay_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_first_data_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_integrations_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_visa_direct_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_mastercard_direct_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_aib_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_card_processor_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_omnipay_direct_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_amex_direct_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_nab_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_moneris_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_paypal_closed_loop_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_tsys_settings\n        - Source Table: pypl-edl.braintree_raw_tables.gateway_custom_actions_settings\n        - Date Range: '2023-08-15' to '2025-01-02'\n        - Date Range: '2023-01-01' to '2025-01-02'\n        - Sampling Factor: abs(mod(farm_fingerprint(cast(retried_transaction_fk as string)), 1000)) < 15\n        - Sampling Factor: abs(mod(farm_fingerprint(cast(retry_txn_id as string)), 1000)) < 900\n        - Sampling Factor: abs(mod(farm_fingerprint(cast(retry_txn_id as string)), 1000)) >= 900 and abs(mod(farm_fingerprint(cast(retry_txn_id as string)), 1000)) < 950\n        - Sampling Factor: abs(mod(farm_fingerprint(cast(retry_txn_id as string)), 1000)) >= 950\n\n    Outputs:\n        - Final Driver Table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_train_3\n        - Final Driver Table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_valid_3\n        - Final Driver Table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_3\n        - Final Driver Table: pypl-edw.pp_scratch.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_3\n",
    "### Driver Creation:\n    Inputs:\n        - source_table_name: \"pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_train\"\n        - source_table_name: \"pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_valid\"\n        - source_table_name: \"pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test\"\n        - spark.jars: \"gs://spark-lib/bigquery/spark-bigquery-with-dependencies_2.12-0.18.1.jar\"\n        - spark.executor.extraClassPath: \"spark-bigquery-with-dependencies_2.12-0.18.1.jar\"\n        - spark.driver.extraClassPath: \"spark-bigquery-with-dependencies_2.12-0.18.1.jar\"\n        - spark.conf.set(\"viewsEnabled\"): \"true\"\n        - spark.conf.set(\"materializationProject\"): \"pypl-edw\"\n        - spark.conf.set(\"materializationDataset\"): \"pp_scratch\"\n        - spark.conf.set('temporaryGcsBucket'): \"pypl-bkt-rsh-row-std-gds-pacman\"\n    Outputs:\n        - target_gcs_path: \"gs://pypl-bkt-rsh-row-std-gds-pacman/user/dnaomi/bt_retry_refresh/pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_train_2\"\n        - target_gcs_path: \"gs://pypl-bkt-rsh-row-std-gds-pacman/user/dnaomi/bt_retry_refresh/pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_valid_2\"\n        - target_gcs_path: \"gs://pypl-bkt-rsh-row-std-gds-pacman/user/dnaomi/bt_retry_refresh/pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_2\"\n",
    "### Model Training:\n    Inputs:\n        - TRAIN_PARQUET_PATH: '/projects/dnaomi/bt-retry-global-v2/data/pypl-bods.gds_pacman_prod.bt_retry_global_v2_driverset_cc_renamed_radd_subset_filtered_full_train_3/'\n        - VAL_PARQUET_PATH: '/projects/dnaomi/bt-retry-global-v2/data/pypl-bods.gds_pacman_prod.bt_retry_global_v2_driverset_cc_renamed_radd_subset_filtered_full_valid_3/'\n        - V2_FEATURES_PATH: '/projects/dnaomi/bt-retry-global-v2/metadata/v2_features.txt'\n        - V1_LATEST_FEATURES_PATH: '/projects/dnaomi/bt-retry-global-v2/metadata/v0_features_latest.txt'\n        - numerical_columns: ['setec_txn_amt_usd', 'idi_bt_unbranded_retry_bin_rdd_cnt_pri_success_ratio_7d', ...] (abbreviated)\n        - integer_columns: []\n        - encoded_columns: []\n        - categorical_columns: ['merchant_fk', 'setec_currency_code', 'primary_response_type', ...] (abbreviated)\n        - target_col: 'retry_is_success'\n        - features: ['setec_txn_amt_usd', 'idi_bt_unbranded_retry_bin_rdd_cnt_pri_success_ratio_7d', ...] (abbreviated)\n        - EARLY_STOPPING_PARAMS: {\"stopping_rounds\": 10}\n        - EARLY_STOPPING_METRIC: \"average_precision\"\n        - METRIC_FUNCTIONS: [precision_at_95, precision_at_99, savings_at_95, savings_at_99, partial_aucpr_geq90]\n        - METRIC_NAMES: [\"precision_at_95\", \"precision_at_99\", \"savings_at_95\", \"savings_at_99\", \"partial_aucpr_geq90\"]\n        - OBJECTIVE_METRIC_NAME: \"partial_aucpr_geq90\"\n        - best_params: {\n            'colsample_bytree': 0.5837239684404587,\n            'learning_rate': 0.0598927112458938,\n            'min_child_samples': 61,\n            'min_data_in_bin': 25,\n            'num_leaves': 217,\n            'num_trees': 141,\n            'n_estimators': 141,\n            'n_jobs': 8,\n            'reg_alpha': 4.784258485091152e-08,\n            'reg_lambda': 0.0002699654851946926,\n            'subsample': 0.6899589770039457,\n            'subsample_freq': 5\n        }\n    Outputs:\n        - Model artifact path: '/projects/dnaomi/bt-retry-global-v2/models/final/bt_retry_v2.txt'\n",
    "### Model Evaluation:\n    Inputs:\n        - DATA_PATH: \"/projects/dnaomi/bt-retry-global-refresh/data/pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_3/\"\n        - V1_FEATURES_PATH: \"/projects/dnaomi/bt-retry-global-refresh/metadata/features_original.txt\"\n        - V1_MODEL_PATH: \"/projects/dnaomi/bt-retry-global/models/lgbm/original_lgbm/original_model.txt\"\n        - V2_FEATURES_PATH: \"/projects/dnaomi/bt-retry-global-refresh/metadata/v2_features_final_2.txt\"\n        - V2_MODEL_PATH: \"/projects/dnaomi/bt-retry-global-refresh/models/final/bt_retry_v2.txt\"\n        - numerical_columns: [\"setec_txn_amt_usd\", \"idi_bt_unbranded_retry_bin_rdd_cnt_pri_success_ratio_7d\", ...] (abbreviated)\n        - integer_columns: []\n        - categorical_columns: [\"merchant_fk\", \"setec_currency_code\", \"primary_response_type\", ...] (abbreviated)\n        - target_col: \"retry_is_success\"\n        - METRIC_FUNCTIONS: [precision_at_95, precision_at_99, precision_at_995, savings_at_95, savings_at_99, savings_at_995, partial_aucpr_geq90]\n        - METRIC_NAMES: [\"precision_at_95\", \"precision_at_99\", \"precision_at_995\", \"savings_at_95\", \"savings_at_99\", \"savings_at_995\", \"partial_aucpr_geq90\"]\n    Outputs:\n        - valid_data_filtered_final.csv: \"/projects/dnaomi/bt-retry-global-refresh/deployment/valid_data_filtered_final.csv\"\n",
    "### Model Packaging:\n    Inputs:\n        - FULL_FEATURES_PATH: \"/projects/dnaomi/bt-retry-global-v2/metadata/v2_features_final_2.txt\"\n        - categorical_columns: [\"merchant_fk\", \"setec_currency_code\", \"primary_response_type\", \"processor_settings_type\", \"retry_strategy_type\", \"card_type\", \"fi_usage\", \"issuer\", \"bin\", \"issuer_cntry_code\", \"is_recurring_txn\", \"payment_instrument_type\", \"is_cvv_present\", \"enrollment_status\", \"token_status\", \"vaulted_credential_type\", \"mcc_code\", \"liability_shift_possible\", \"success_3ds\", \"verifications_txn\", \"fastlane_txn\"]\n        - model_file: \"/projects/dnaomi/bt-retry-global-v2/models/bt_retry_v2_small.txt\"\n        - path_to_json: \"/projects/dnaomi/bt-retry-global-v2/models/bt_retry_v2_model_idi.json\"\n        - model_name: \"bt_retry_v2\"\n        - tree_nodes_only: False\n        - output_name: \"bt_retry_v2_score\"\n    Outputs:\n        - model_json_with_pd_path: \"/projects/dnaomi/bt-retry-global-v2/models/bt_retry_v2_model_idi.json\"\n        - output_path: \"/projects/dnaomi/bt-retry-global-v2/models/ume/\"\n",
    "[Model Scoring]:\n    Inputs:\n        - numerical_columns: [\"setec_txn_amt_usd\", \"idi_bt_unbranded_retry_bin_rdd_cnt_pri_success_ratio_7d\", ...]  # abbreviated\n        - integer_columns: []\n        - categorical_columns: [\"merchant_fk\", \"setec_currency_code\", \"primary_response_type\", ...]  # abbreviated\n        - target_col: \"retry_is_success\"\n        - MODELS_DIR: \"/home/dnaomi/bt-retry-global-refresh/models/ume/\"\n        - MODEL_DIR: \"/home/dnaomi/bt-retry-global-refresh/models/ume/\"\n        - MODEL_UME_NAME: \"bt_retry_v2\"\n        - VALID_SAMPLE_PATH: \"/home/dnaomi/bt-retry-global-refresh/deployment/valid_data_filtered_final.csv\"\n        - features: list_from_txt(\"/projects/dnaomi/bt-retry-global-refresh/metadata/v2_features_final_2.txt\")\n        - model_file: os.path.join(MODEL_DIR, \"ume/bt_retry_v2.m\")\n    Outputs:\n        - ume_predictions_valid: DataFrame with UME model predictions\n        - ume_preds_filtered: DataFrame with filtered UME model predictions\n        - scored_data_path: '/projects/dnaomi/bt-retry-global-refresh/deployment/cosmos_ai_valid_data.csv'\n"
  ]
}