{
  "node_aggregator": "- Driver Creation:\n    file_name: rmr_agent/repos/bt-retry-v2/etl/01_etl.py\n    line_range: 1-1125\n    inputs:\n      base_transactions_table: pypl-edl.braintree_raw_tables.gateway_transactions\n      retry_transactions_table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_retry_transactions\n      primary_retry_transactions_table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_primary_retry_transactions\n      fx_info_table: pypl-edw.pp_access_views.dim_curr_exchng_rate_dly\n      authy_merchants_table: pypl-edl.braintree_raw_tables.authy_merchants\n      payment_methods_table: pypl-edl.braintree_raw_tables.gateway_payment_methods\n      credit_cards_table: pypl-edl.braintree_raw_tables.gateway_credit_cards\n      network_tokenization_enrollments_table: pypl-edl.braintree_raw_tables.gateway_network_tokenization_enrollments\n      credit_card_details_table: pypl-edl.braintree_raw_tables.gateway_credit_card_details\n      bin_features_table: pypl-edw.pp_cmt_access_views.bt_unbranded_retry_bin\n      strategy_features_table: pypl-edw.pp_cmt_access_views.bt_unbranded_retry_strategy\n      bin_strategy_features_table: pypl-edw.pp_cmt_access_views.bt_unbranded_retry_bin_strategy\n      three_d_secure_results_table: pypl-edl.braintree_raw_tables.gateway_three_d_secure_results\n      three_d_secure_verifications_table: pypl-edl.braintree_raw_tables.gateway_three_d_secure_verifications\n      verifications_table: pypl-edl.braintree_raw_tables.gateway_verifications\n      vaulted_payment_method_grants_table: pypl-edl.braintree_raw_tables.gateway_vaulted_payment_method_grants\n      salem_settings_table: pypl-edl.braintree_raw_tables.gateway_salem_settings\n      adyen_settings_table: pypl-edl.braintree_raw_tables.gateway_adyen_settings\n      world_pay_settings_table: pypl-edl.braintree_raw_tables.gateway_world_pay_settings\n      first_data_settings_table: pypl-edl.braintree_raw_tables.gateway_first_data_settings\n      visa_direct_settings_table: pypl-edl.braintree_raw_tables.gateway_visa_direct_settings\n      mastercard_direct_settings_table: pypl-edl.braintree_raw_tables.gateway_mastercard_direct_settings\n      aib_settings_table: pypl-edl.braintree_raw_tables.gateway_aib_settings\n      card_processor_settings_table: pypl-edl.braintree_raw_tables.gateway_card_processor_settings\n      omnipay_direct_settings_table: pypl-edl.braintree_raw_tables.gateway_omnipay_direct_settings\n      amex_direct_settings_table: pypl-edl.braintree_raw_tables.gateway_amex_direct_settings\n      nab_settings_table: pypl-edl.braintree_raw_tables.gateway_nab_settings\n      moneris_settings_table: pypl-edl.braintree_raw_tables.gateway_moneris_settings\n      paypal_closed_loop_settings_table: pypl-edl.braintree_raw_tables.gateway_paypal_closed_loop_settings\n      tsys_settings_table: pypl-edl.braintree_raw_tables.gateway_tsys_settings\n      custom_actions_settings_table: pypl-edl.braintree_raw_tables.gateway_custom_actions_settings\n      fake_processor_settings_table: pypl-edl.braintree_raw_tables.gateway_fake_processor_settings\n      date_range_start: '2023-08-15'\n      date_range_end: '2025-01-02'\n      sampling_factor: '15'\n      train_downsampling_factor: '900'\n      validation_downsampling_factor_start: '900'\n      validation_downsampling_factor_end: '950'\n      oot_downsampling_factor: '950'\n    outputs:\n      final_driver_table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_3\n      train_table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_train_3\n      validation_table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_valid_3\n      test_table: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_3\n      scratch_test_table: pypl-edw.pp_scratch.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_3\n- Driver Creation:\n    file_name: rmr_agent/repos/bt-retry-v2/etl/02_bq_to_dataproc.py\n    line_range: 1-40\n    inputs:\n      spark_jars: gs://spark-lib/bigquery/spark-bigquery-with-dependencies_2.12-0.18.1.jar\n      spark_executor_extraClassPath: spark-bigquery-with-dependencies_2.12-0.18.1.jar\n      spark_driver_extraClassPath: spark-bigquery-with-dependencies_2.12-0.18.1.jar\n      viewsEnabled: 'true'\n      materializationProject: pypl-edw\n      materializationDataset: pp_scratch\n      temporaryGcsBucket: pypl-bkt-rsh-row-std-gds-pacman\n      source_table_name_train: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_train\n      source_table_name_valid: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_valid\n      source_table_name_test: pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test\n    outputs:\n      target_gcs_path_train: gs://pypl-bkt-rsh-row-std-gds-pacman/user/dnaomi/bt_retry_refresh/pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_train_2\n      target_gcs_path_valid: gs://pypl-bkt-rsh-row-std-gds-pacman/user/dnaomi/bt_retry_refresh/pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_valid_2\n      target_gcs_path_test: gs://pypl-bkt-rsh-row-std-gds-pacman/user/dnaomi/bt_retry_refresh/pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_2\n- Model Evaluation:\n    file_name: rmr_agent/repos/bt-retry-v2/model-dev/evaluate.py\n    line_range: 1-383\n    inputs:\n      DATA_PATH: /projects/dnaomi/bt-retry-global-refresh/data/pypl-bods.gds_pacman_prod.bt_retry_global_refresh_driverset_cc_renamed_radd_subset_filtered_full_test_3/\n      V1_FEATURES_PATH: /projects/dnaomi/bt-retry-global-refresh/metadata/features_original.txt\n      V1_MODEL_PATH: /projects/dnaomi/bt-retry-global/models/lgbm/original_lgbm/original_model.txt\n      V2_FEATURES_PATH: /projects/dnaomi/bt-retry-global-refresh/metadata/v2_features_final_2.txt\n      V2_MODEL_PATH: /projects/dnaomi/bt-retry-global-refresh/models/final/bt_retry_v2.txt\n      numerical_columns: \"[\\\"setec_txn_amt_usd\\\", \\\"idi_bt_unbranded_retry_bin_rdd_cnt_pri_success_ratio_7d\\\"\\\n        , ...]\"\n      integer_columns: \"[]\"\n      categorical_columns: \"[\\\"merchant_fk\\\", \\\"setec_currency_code\\\", \\\"primary_response_type\\\"\\\n        , ...]\"\n      target_col: retry_is_success\n      METRIC_NAMES: \"[\\\"precision_at_95\\\", \\\"precision_at_99\\\", \\\"precision_at_995\\\"\\\n        , \\\"savings_at_95\\\", \\\"savings_at_99\\\", \\\"savings_at_995\\\", \\\"partial_aucpr_geq90\\\"\\\n        ]\"\n    outputs:\n      valid_data_filtered_path: /projects/dnaomi/bt-retry-global-refresh/deployment/valid_data_filtered_final.csv\n- Model Training:\n    file_name: rmr_agent/repos/bt-retry-v2/model-dev/train.py\n    line_range: 1-367\n    inputs:\n      train_data_path: /projects/dnaomi/bt-retry-global-v2/data/pypl-bods.gds_pacman_prod.bt_retry_global_v2_driverset_cc_renamed_radd_subset_filtered_full_train_3/\n      val_data_path: /projects/dnaomi/bt-retry-global-v2/data/pypl-bods.gds_pacman_prod.bt_retry_global_v2_driverset_cc_renamed_radd_subset_filtered_full_valid_3/\n      features_path: /projects/dnaomi/bt-retry-global-v2/metadata/v2_features.txt\n      latest_features_path: /projects/dnaomi/bt-retry-global-v2/metadata/v0_features_latest.txt\n      numerical_columns: \"[\\\"setec_txn_amt_usd\\\", \\\"idi_bt_unbranded_retry_bin_rdd_cnt_pri_success_ratio_7d\\\"\\\n        , ...]\"\n      integer_columns: \"[]\"\n      categorical_columns: \"[\\\"merchant_fk\\\", \\\"setec_currency_code\\\", \\\"primary_response_type\\\"\\\n        , ...]\"\n      target_col: retry_is_success\n      best_params: |-\n        - colsample_bytree: 0.5837239684404587\n                    - learning_rate: 0.0598927112458938\n                    - min_child_samples: 61\n                    - min_data_in_bin: 25\n                    - num_leaves: 217\n                    - num_trees: 141\n                    - n_estimators: 141\n                    - n_jobs: 8\n                    - reg_alpha: 4.784258485091152e-08\n                    - reg_lambda: 0.0002699654851946926\n                    - subsample: 0.6899589770039457\n                    - subsample_freq: 5\n      early_stopping_params: \"{\\\"stopping_rounds\\\": 10}\"\n      early_stopping_metric: average_precision\n      objective_metric_name: partial_aucpr_geq90\n    outputs:\n      model_artifact_path: /projects/dnaomi/bt-retry-global-v2/models/final/bt_retry_v2.txt\n      feature_importance_path: /projects/dnaomi/bt-retry-global-v2/metadata/v2_features_final.txt\n      metrics_output_path: /projects/dnaomi/bt-retry-global-v2/metadata/metrics_output.csv\n      mlflow_tracking_url: https://mlflow.apps.cosmos-onprem.dp.lvs.paypalinc.com\n      experiment_name: bt_retry_global_v2_full_fts_strategy_subset_model_all_strat_valid_control\n      study_name: bt-retry-global-v1-full-fts-strategy-subset-model-all-strat-valid-control\n      studies_dir: ../reports/studies/\n      study_dir: ../reports/studies/bt-retry-global-v1-full-fts-strategy-subset-model-all-strat-valid-control\n      optuna_study_path: ../reports/studies/bt-retry-global-v1-full-fts-strategy-subset-model-all-strat-valid-control/bt-retry-global-v1-full-fts-strategy-subset-model-all-strat-valid-control.pkl\n      stdout_path: ../reports/studies/bt-retry-global-v1-full-fts-strategy-subset-model-all-strat-valid-control-stdout.txt\n      stderr_path: ../reports/studies/bt-retry-global-v1-full-fts-strategy-subset-model-all-strat-valid-control-stdout.txt\n- Model Packaging:\n    file_name: rmr_agent/repos/bt-retry-v2/deployment/01_export_to_ume.py\n    line_range: 1-60\n    inputs:\n      FULL_FEATURES_PATH: /projects/dnaomi/bt-retry-global-v2/metadata/v2_features_final_2.txt\n      categorical_columns: \"[\\\"merchant_fk\\\", \\\"setec_currency_code\\\", \\\"primary_response_type\\\"\\\n        , \\\"processor_settings_type\\\", \\\"retry_strategy_type\\\", \\\"card_type\\\", \\\"\\\n        fi_usage\\\", \\\"issuer\\\", \\\"bin\\\", \\\"issuer_cntry_code\\\", \\\"is_recurring_txn\\\"\\\n        , \\\"payment_instrument_type\\\", \\\"is_cvv_present\\\", \\\"enrollment_status\\\",\\\n        \\ \\\"token_status\\\", \\\"vaulted_credential_type\\\", \\\"mcc_code\\\", \\\"liability_shift_possible\\\"\\\n        , \\\"success_3ds\\\", \\\"verifications_txn\\\", \\\"fastlane_txn\\\"]\"\n      model_file: /projects/dnaomi/bt-retry-global-v2/models/bt_retry_v2_small.txt\n      path_to_json: /projects/dnaomi/bt-retry-global-v2/models/bt_retry_v2_model_idi.json\n      model_name: bt_retry_v2\n      tree_nodes_only: 'False'\n      output_name: bt_retry_v2_score\n    outputs:\n      model_json_with_pd_path: /projects/dnaomi/bt-retry-global-v2/models/bt_retry_v2_model_idi.json\n      output_path: /projects/dnaomi/bt-retry-global-v2/models/ume/\n- Feature Selection:\n    file_name: research/driver_creation.ipynb\n    line_range: Lines 258-311\n    inputs:\n      numerical_columns: \"[\\\"setec_txn_amt_usd\\\", \\\"idi_bt_unbranded_retry_bin_rdd_cnt_pri_success_ratio_7d\\\"\\\n        , ...]\"\n      integer_columns: \"[]\"\n      encoded_columns: \"[]\"\n      categorical_columns: \"[\\\"merchant_fk\\\", \\\"setec_currency_code\\\", \\\"primary_response_type\\\"\\\n        , ...]\"\n      target_col: retry_is_success\n    outputs: {}\n- Model Training:\n    file_name: research/driver_creation.ipynb\n    line_range: Lines 258-311\n    inputs:\n      MODEL_DIR: /home/dnaomi/bt-retry-global-refresh/models/ume/\n      MODEL_UME_NAME: bt_retry_v2\n    outputs: {}\n- Model Validation:\n    file_name: research/driver_creation.ipynb\n    line_range: Lines 258-311\n    inputs:\n      VALID_SAMPLE_PATH: /home/dnaomi/bt-retry-global-refresh/deployment/valid_data_filtered_final.csv\n      numerical_columns: \"[\\\"setec_txn_amt_usd\\\", \\\"idi_bt_unbranded_retry_bin_rdd_cnt_pri_success_ratio_7d\\\"\\\n        , ...]\"\n      integer_columns: \"[]\"\n      categorical_columns: \"[\\\"merchant_fk\\\", \\\"setec_currency_code\\\", \\\"primary_response_type\\\"\\\n        , ...]\"\n    outputs: {}\n- Feature List Loading:\n    file_name: research/driver_creation.ipynb\n    line_range: Lines 258-311\n    inputs:\n      features_file_path: /projects/dnaomi/bt-retry-global-refresh/metadata/v2_features_final_2.txt\n    outputs:\n      features: \"[\\\"feature_1\\\", \\\"feature_2\\\", ...]\"\n- Model Prediction:\n    file_name: research/driver_creation.ipynb\n    line_range: Lines 258-311\n    inputs:\n      model_file: /home/dnaomi/bt-retry-global-refresh/models/ume/ume/bt_retry_v2.m\n      valid_sample: DataFrame loaded from VALID_SAMPLE_PATH\n    outputs:\n      ume_predictions_valid: DataFrame with predictions\n- Filtered Predictions Saving:\n    file_name: research/driver_creation.ipynb\n    line_range: Lines 258-311\n    inputs:\n      ume_preds_filtered: DataFrame with filtered predictions\n    outputs:\n      filtered_predictions_path: /projects/dnaomi/bt-retry-global-refresh/deployment/cosmos_ai_valid_data.csv\n- Model Validation with LightGBM:\n    file_name: research/driver_creation.ipynb\n    line_range: Lines 258-311\n    inputs:\n      model_file: /home/dnaomi/bt-retry-global-refresh/models/ume/ume/bt_retry_v2.m\n      VALID_SAMPLE_PATH: /home/dnaomi/bt-retry-global-refresh/deployment/valid_data_filtered_final.csv\n      score_column: v2_score\n      delta: 1e-6\n    outputs:\n      valid_mismatches: Validation results\n"
}